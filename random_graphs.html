
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Random network models &#8212; Network Data Science</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/nd_logo_small.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Clarke - final project placeholder" href="clarke.html" />
    <link rel="prev" title="Centrality measures" href="centrality.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-JYHFQNEPZN"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-JYHFQNEPZN');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/nd_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Network Data Science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="landing.html">
   Welcome
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Course logistics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calendar.html">
   Calendar
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mini_assignment.html">
   Mini-assignment
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="datasets.html">
   Datasets
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://bdpedigo.github.io/networks-course/welcome.html">
   Welcome
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://bdpedigo.github.io/networks-course/what_are_networks.html">
   What are networks?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="representing_networks.html">
   Representing networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plotting_networks.html">
   Plotting networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="centrality.html">
   Centrality measures
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Random network models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Projects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="clarke.html">
   Clarke - final project placeholder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fry.html">
   Fry - final project placeholder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="geason.html">
   Geason - final project placeholder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="larson.html">
   Larson - final project placeholder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="liu.html">
   Liu - final project placeholder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="song.html">
   Song - final project placeholder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sood.html">
   Sood - Final project placeholder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="wang.html">
   Wang - final project placeholder
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="harounakenfack.html">
   HarounaKenfack - final project placeholder
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/random_graphs.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/bdpedigo/networks-course"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/bdpedigo/networks-course/issues/new?title=Issue%20on%20page%20%2Frandom_graphs.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/bdpedigo/networks-course/edit/main/docs/random_graphs.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/bdpedigo/networks-course/main?urlpath=tree/docs/random_graphs.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-use-random-network-models">
   Why use random network models?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-some-data-from-graspologic">
   Load some data from
   <em>
    graspologic
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notation">
   Notation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#independent-edge-models">
   Independent edge models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#erdos-reyni-er">
     Erdos-Reyni (ER)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#degree-corrected-erdos-reyni-dcer">
     Degree-corrected Erdos-Reyni (DCER)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stochastic-block-model-sbm">
     Stochastic block model (SBM)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#degree-corrected-stochastic-block-model-dcsbm">
     Degree-corrected stochastic block model (DCSBM)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-dot-product-graph-rdpg">
     Random dot product graph (RDPG)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-all-of-the-models-on-this-dataset">
     Compare all of the models on this dataset
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relationships-among-these-models">
     Relationships among these models
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#barabasi-albert-model">
   Barabasi-Albert model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-models">
   Other models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bespoke-models">
   “Bespoke” models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Random network models</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#why-use-random-network-models">
   Why use random network models?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-some-data-from-graspologic">
   Load some data from
   <em>
    graspologic
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notation">
   Notation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#independent-edge-models">
   Independent edge models
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#erdos-reyni-er">
     Erdos-Reyni (ER)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#degree-corrected-erdos-reyni-dcer">
     Degree-corrected Erdos-Reyni (DCER)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stochastic-block-model-sbm">
     Stochastic block model (SBM)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#degree-corrected-stochastic-block-model-dcsbm">
     Degree-corrected stochastic block model (DCSBM)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-dot-product-graph-rdpg">
     Random dot product graph (RDPG)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-all-of-the-models-on-this-dataset">
     Compare all of the models on this dataset
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relationships-among-these-models">
     Relationships among these models
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#barabasi-albert-model">
   Barabasi-Albert model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-models">
   Other models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bespoke-models">
   “Bespoke” models
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="random-network-models">
<h1>Random network models<a class="headerlink" href="#random-network-models" title="Permalink to this headline">¶</a></h1>
<p>This notebook on random network models is adapted from the <a class="reference external" href="https://microsoft.github.io/graspologic/latest/tutorials/models/models.html"><code class="docutils literal notranslate"><span class="pre">graspoloigc</span></code> tutorial</a> on the same topic.</p>
<p>You may also be interested in <a class="reference external" href="http://docs.neurodata.io/graph-stats-book/representations/ch5/why-use-models.html">a similar section in <em>Hands-on Network Machine Learning with Scikit-Learn and Graspologic</em></a>.</p>
<p>In this notebook, we’ll look at the following models:</p>
<ul class="simple">
<li><p>Erdos-Reyni (ER)</p></li>
<li><p>Degree-corrected Erdos-Reyni (DCER)</p></li>
<li><p>Stochastic block model (SBM)</p></li>
<li><p>Degree-corrected stochastic block model (DCSBM)</p></li>
<li><p>Random dot product graph (RDPG)</p></li>
</ul>
<div class="section" id="why-use-random-network-models">
<h2>Why use random network models?<a class="headerlink" href="#why-use-random-network-models" title="Permalink to this headline">¶</a></h2>
<p>There are a few different reasons one might want to use a statistical network model.</p>
<p>First, these models can be a concise, mathematical way of formalizing a conception of
the process involved in generating a network.</p>
<p>Second, we may want to use a simple model which captures some aspects of our network’s
structure to compare to - for instance, how does the community structure of a network
we observe compare to a network generated from a Random Dot Product Graph (more on this
later)?</p>
<p>Third, these models are often useful for motivating or proving properties of how our
algorithms perform on data.</p>
<p>Fourth, these models (and their parameters) can be a lens through which we can compare
networks.</p>
<p>I note that these are mostly my opinions, and other people’s reasons for using
statistical network models might differ. For whatever the reason, these models come up
in research a ton. Let’s look at a few of these models below.</p>
</div>
<div class="section" id="load-some-data-from-graspologic">
<h2>Load some data from <em>graspologic</em><a class="headerlink" href="#load-some-data-from-graspologic" title="Permalink to this headline">¶</a></h2>
<p>For this example we will use the <em>Drosophila melanogaster</em> larva right mushroom body connectome from <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/28796202">Eichler et al. 2017</a>. Here we will consider a binarized and directed version of the graph. Note that I will make this graph unweighted, because most statistical
network models are concerned with binary networks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">graspologic.datasets</span> <span class="kn">import</span> <span class="n">load_drosophila_right</span>
<span class="kn">from</span> <span class="nn">graspologic.plot</span> <span class="kn">import</span> <span class="n">heatmap</span>
<span class="kn">from</span> <span class="nn">graspologic.utils</span> <span class="kn">import</span> <span class="n">binarize</span>

<span class="n">adj</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">load_drosophila_right</span><span class="p">(</span><span class="n">return_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">adj</span> <span class="o">=</span> <span class="n">binarize</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>

<span class="n">degrees</span> <span class="o">=</span> <span class="n">adj</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">adj</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sort_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">degrees</span><span class="p">)</span>
<span class="n">adj</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span><span class="n">sort_inds</span><span class="p">][:,</span> <span class="n">sort_inds</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">sort_inds</span><span class="p">]</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">heatmap</span><span class="p">(</span>
    <span class="n">adj</span><span class="p">,</span>
    <span class="n">inner_hier_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Drosophila right MB&quot;</span><span class="p">,</span>
    <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">sort_nodes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/random_graphs_5_0.png" src="_images/random_graphs_5_0.png" />
</div>
</div>
</div>
<div class="section" id="notation">
<h2>Notation<a class="headerlink" href="#notation" title="Permalink to this headline">¶</a></h2>
<p><span class="math notranslate nohighlight">\(n\)</span> - the number of nodes in the graph</p>
<p><span class="math notranslate nohighlight">\(A\)</span> - <span class="math notranslate nohighlight">\(n \times n\)</span> adjacency matrix</p>
<p><span class="math notranslate nohighlight">\(P\)</span> - <span class="math notranslate nohighlight">\(n \times n\)</span> matrix of probabilities</p>
</div>
<div class="section" id="independent-edge-models">
<h2>Independent edge models<a class="headerlink" href="#independent-edge-models" title="Permalink to this headline">¶</a></h2>
<p>Many statistical network models fall under the umbrella of independent edge random networks, sometimes called the <strong>Inhomogeneous Erdos-Renyi (IER)</strong> model. Under this model, the elements of the network’s adjacency matrix <span class="math notranslate nohighlight">\(A\)</span> are sampled independently from a Bernoulli distribution:</p>
<div class="math notranslate nohighlight">
\[A_{ij} \sim Bernoulli(P_{ij})\]</div>
<p>If <span class="math notranslate nohighlight">\(n\)</span> is the number of nodes, the matrix <span class="math notranslate nohighlight">\(P\)</span> is a <span class="math notranslate nohighlight">\(n \times n\)</span> matrix of probabilities with elements in <span class="math notranslate nohighlight">\([0, 1]\)</span>. Depending on how the matrix <span class="math notranslate nohighlight">\(P\)</span> is constructed, we can create various different specific models. We next describe several of these choices. Note that for each model, we assume that there are no loops, or in other words the diagonal of the matrix <span class="math notranslate nohighlight">\(P\)</span> will always be set to zero.</p>
<p><em>For each graph model we will show:</em></p>
<ul class="simple">
<li><p>how the model is formulated</p></li>
<li><p>how to fit the model using <code class="docutils literal notranslate"><span class="pre">graspologic</span></code></p></li>
<li><p>the <span class="math notranslate nohighlight">\(P\)</span> matrix that was fit by the model</p></li>
<li><p>a single sample of a new network from the fit model</p></li>
</ul>
<div class="section" id="erdos-reyni-er">
<h3>Erdos-Reyni (ER)<a class="headerlink" href="#erdos-reyni-er" title="Permalink to this headline">¶</a></h3>
<p>The <strong>Erdos-Reyni (ER)</strong> model is the simplest random graph model. We are interested in modeling the probability of an edge existing between any two nodes, <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>. We denote this probability <span class="math notranslate nohighlight">\(P_{ij}\)</span>. For the ER model:</p>
<div class="math notranslate nohighlight">
\[P_{ij} = p\]</div>
<p>for any combination of <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>.<br />
This means that the one parameter <span class="math notranslate nohighlight">\(p\)</span> is the overall probability of connection for any two nodes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graspologic.models</span> <span class="kn">import</span> <span class="n">EREstimator</span>

<span class="n">er</span> <span class="o">=</span> <span class="n">EREstimator</span><span class="p">(</span><span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">er</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ER &quot;p&quot; parameter: </span><span class="si">{</span><span class="n">er</span><span class="o">.</span><span class="n">p_</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_model_and_sample</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">heatmap</span><span class="p">(</span>
        <span class="n">estimator</span><span class="o">.</span><span class="n">p_mat_</span><span class="p">,</span>
        <span class="n">inner_hier_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> probability matrix&quot;</span><span class="p">,</span>
        <span class="n">sort_nodes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">heatmap</span><span class="p">(</span>
        <span class="n">estimator</span><span class="o">.</span><span class="n">sample</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">inner_hier_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> sample&quot;</span><span class="p">,</span>
        <span class="n">sort_nodes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

<span class="n">plot_model_and_sample</span><span class="p">(</span><span class="n">er</span><span class="p">,</span> <span class="s1">&#39;ER&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ER &quot;p&quot; parameter: 0.1661046088739007
</pre></div>
</div>
<img alt="_images/random_graphs_10_1.png" src="_images/random_graphs_10_1.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">networkx</span></code> also has an ER sampler. Note the <code class="docutils literal notranslate"><span class="pre">directed</span></code> kwarg.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>

<span class="n">n</span> <span class="o">=</span> <span class="n">adj</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">er</span><span class="o">.</span><span class="n">p_</span>

<span class="n">nx</span><span class="o">.</span><span class="n">erdos_renyi_graph</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;networkx.classes.digraph.DiGraph at 0x13fc88400&gt;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="degree-corrected-erdos-reyni-dcer">
<h3>Degree-corrected Erdos-Reyni (DCER)<a class="headerlink" href="#degree-corrected-erdos-reyni-dcer" title="Permalink to this headline">¶</a></h3>
<p>A slightly more complicated variant of the ER model is the <strong>degree-corrected Erdos-Reyni model (DCER)</strong>. Here, there is still a global parameter <span class="math notranslate nohighlight">\(p\)</span> to specify relative connection probability between all edges. However, we add a promiscuity parameter <span class="math notranslate nohighlight">\(\theta_i\)</span> for each node <span class="math notranslate nohighlight">\(i\)</span> which specifies its expected degree relative to other nodes:</p>
<div class="math notranslate nohighlight">
\[P_{ij} = \theta_i \theta_j p\]</div>
<p>so the probability of an edge from <span class="math notranslate nohighlight">\(i\)</span> to <span class="math notranslate nohighlight">\(j\)</span> is a function of the two nodes’ degree-correction parameters, and the overall probability of an edge in the graph.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a commonly used network model called the <strong>configuration model</strong> which exactly
specifies the degree sequence, and is usually sampled somewhat differently. We use the
DCER term for consistency with the rest of these models, but note that this is very
similar in spirit to a configuration model.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This model has what is called a <strong>nonidentifiability</strong> this can be thought of as having
some flexibility in the model parameters which has no effect on the model itself. We
could multiply <span class="math notranslate nohighlight">\(p\)</span> by 2, and divide the vector <span class="math notranslate nohighlight">\(\theta\)</span> by 2, and have the same matrix
<span class="math notranslate nohighlight">\(P\)</span>. As an aside, nonidentifiabilities are important to consider when comparing
parameters. Here, we just use the convention that <span class="math notranslate nohighlight">\(\theta\)</span> sum to 1, which gives <span class="math notranslate nohighlight">\(p\)</span> the
interpretation as the expected number of edges.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graspologic.models</span> <span class="kn">import</span> <span class="n">DCEREstimator</span>

<span class="n">dcer</span> <span class="o">=</span> <span class="n">DCEREstimator</span><span class="p">(</span><span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dcer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">adj</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;DCER &quot;p&quot; parameter: </span><span class="si">{</span><span class="n">dcer</span><span class="o">.</span><span class="n">p_</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plot_model_and_sample</span><span class="p">(</span><span class="n">dcer</span><span class="p">,</span> <span class="s1">&#39;DCER&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DCER &quot;p&quot; parameter: 7536.0
</pre></div>
</div>
<img alt="_images/random_graphs_14_1.png" src="_images/random_graphs_14_1.png" />
</div>
</div>
</div>
<div class="section" id="stochastic-block-model-sbm">
<h3>Stochastic block model (SBM)<a class="headerlink" href="#stochastic-block-model-sbm" title="Permalink to this headline">¶</a></h3>
<p>Under the <strong>stochastic block model (SBM)</strong>, each node is modeled as belonging to a block (sometimes called a community or group). The probability of node <span class="math notranslate nohighlight">\(i\)</span> connecting to node <span class="math notranslate nohighlight">\(j\)</span> is simply a function of the block membership of the two nodes. Let <span class="math notranslate nohighlight">\(n\)</span> be the number of nodes in the graph, then <span class="math notranslate nohighlight">\(\tau\)</span> is a length <span class="math notranslate nohighlight">\(n\)</span> vector which indicates the block membership of each node in the graph. Let <span class="math notranslate nohighlight">\(K\)</span> be the number of blocks, then <span class="math notranslate nohighlight">\(B\)</span> is a <span class="math notranslate nohighlight">\(K \times K\)</span> matrix of block-block connection probabilities.</p>
<div class="math notranslate nohighlight">
\[P_{ij} = B_{\tau_i \tau_j}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graspologic.models</span> <span class="kn">import</span> <span class="n">SBMEstimator</span>

<span class="n">sbme</span> <span class="o">=</span> <span class="n">SBMEstimator</span><span class="p">(</span><span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sbme</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SBM &quot;B&quot; matrix:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sbme</span><span class="o">.</span><span class="n">block_p_</span><span class="p">)</span>

<span class="n">plot_model_and_sample</span><span class="p">(</span><span class="n">sbme</span><span class="p">,</span> <span class="s1">&#39;SBM&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SBM &quot;B&quot; matrix:
[[0.         0.38333333 0.11986864 0.        ]
 [0.44571429 0.3584     0.49448276 0.        ]
 [0.09359606 0.         0.20095125 0.        ]
 [0.         0.07587302 0.         0.        ]]
</pre></div>
</div>
<img alt="_images/random_graphs_16_1.png" src="_images/random_graphs_16_1.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">networkx</span></code> also has an SBM sampler.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">]</span> <span class="c1"># size in each group</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]]</span> <span class="c1"># matrix of probabilities</span>

<span class="n">nx</span><span class="o">.</span><span class="n">stochastic_block_model</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;networkx.classes.digraph.DiGraph at 0x13f612550&gt;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="degree-corrected-stochastic-block-model-dcsbm">
<h3>Degree-corrected stochastic block model (DCSBM)<a class="headerlink" href="#degree-corrected-stochastic-block-model-dcsbm" title="Permalink to this headline">¶</a></h3>
<p>Just as we could add a degree-correction term to the ER model, so too can we modify the stochastic block model to allow for heterogeneous expected degrees. This yields the <strong>degree-corrected stochastic block model.</strong> Again, we let <span class="math notranslate nohighlight">\(\theta\)</span> be a length <span class="math notranslate nohighlight">\(n\)</span> vector of degree correction parameters, and all other parameters remain as they were defined above for the SBM:</p>
<div class="math notranslate nohighlight">
\[P_{ij} = \theta_i \theta_j B_{\tau_i, \tau_j}\]</div>
<p>Note that the matrix <span class="math notranslate nohighlight">\(B\)</span> may no longer represent true probabilities, because the addition of the <span class="math notranslate nohighlight">\(\theta\)</span> vectors introduces a multiplicative constant that can be absorbed into the elements of <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graspologic.models</span> <span class="kn">import</span> <span class="n">DCSBMEstimator</span>

<span class="n">dcsbme</span> <span class="o">=</span> <span class="n">DCSBMEstimator</span><span class="p">(</span><span class="n">directed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dcsbme</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DCSBM &quot;B&quot; matrix:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dcsbme</span><span class="o">.</span><span class="n">block_p_</span><span class="p">)</span>

<span class="n">plot_model_and_sample</span><span class="p">(</span><span class="n">dcsbme</span><span class="p">,</span> <span class="s1">&#39;DCSBM&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DCSBM &quot;B&quot; matrix:
[[   0.  805.   73.    0.]
 [ 936. 3584. 1434.    0.]
 [  57.    0.  169.    0.]
 [   0.  478.    0.    0.]]
</pre></div>
</div>
<img alt="_images/random_graphs_20_1.png" src="_images/random_graphs_20_1.png" />
</div>
</div>
</div>
<div class="section" id="random-dot-product-graph-rdpg">
<h3>Random dot product graph (RDPG)<a class="headerlink" href="#random-dot-product-graph-rdpg" title="Permalink to this headline">¶</a></h3>
<p>The <strong>random dot product graph model (RDPG)</strong> <span id="id1">[<a class="reference internal" href="#id26">1</a>, <a class="reference internal" href="#id34">2</a>]</span> is a (relatively speaking) newer network model under the umbrella of latent position random graphs <span id="id2">[<a class="reference internal" href="#id33">3</a>]</span>. Under <strong>latent position models</strong>, each node has an associated, typically unobserved vector which is referred to as the <strong>latent position</strong> of that node. For the directed network case, we can allow each node to have associated “in” and “out” latent position vectors which may not be the same, with the former governing the nodes inputs and the latter governing its outputs. If <span class="math notranslate nohighlight">\(x_i\)</span> is the out latent position for node <span class="math notranslate nohighlight">\(i\)</span>, and <span class="math notranslate nohighlight">\(y_j\)</span> the input latent position for node <span class="math notranslate nohighlight">\(j\)</span>, then the probability of an edge between <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> is some function of these vectors:</p>
<div class="math notranslate nohighlight">
\[P[A_{ij} = 1] = P_{ij} = f(x_i, y_j)\]</div>
<p>More specifically for the RDPG, the link function <span class="math notranslate nohighlight">\(f\)</span> is the dot product:</p>
<div class="math notranslate nohighlight">
\[P[A_{ij} = 1] = P_{ij} = \langle x_i, y_j \rangle\]</div>
<p>The latent positions are thus restricted such that <span class="math notranslate nohighlight">\(\langle x_i, y_j \rangle \in [0, 1]\)</span> for all <span class="math notranslate nohighlight">\((i,j)\)</span> pairs. Under this definition, <span class="math notranslate nohighlight">\(P\)</span>, the matrix of connection probabilities, can be written as <span class="math notranslate nohighlight">\(P = XY^T\)</span>, where <span class="math notranslate nohighlight">\(X \in \mathbb{R}^{n \times d}\)</span> is a matrix where each row <span class="math notranslate nohighlight">\(i\)</span> is the out latent position of node <span class="math notranslate nohighlight">\(i\)</span>, and likewise for <span class="math notranslate nohighlight">\(Y\)</span> and the in latent positions.</p>
<div class="tip admonition">
<p class="admonition-title">Question</p>
<p>Imagine that the out and in latent positions are the same (<span class="math notranslate nohighlight">\(x_i = y_i\)</span>). Describe a
restriction on the latent positions (say, a region of space) such that all probabilities
are well defined.</p>
<p>Hint: what would the restriction be when <span class="math notranslate nohighlight">\(d=1\)</span>? When <span class="math notranslate nohighlight">\(d=2\)</span>?</p>
</div>
<p>In practical applications, we never observe the latent positions in <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> - they must be estimated from the observed network, <span class="math notranslate nohighlight">\(A\)</span>. Fortunately, this can be done via an established technique known as <strong>adjacency spectral embedding (ASE)</strong> <span id="id3">[<a class="reference internal" href="#id26">1</a>]</span>, which was recently shown to be a consistent estimator of these latent positions. We’ll discuss this more when we talk about network embeddings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graspologic.models</span> <span class="kn">import</span> <span class="n">RDPGEstimator</span>

<span class="n">rdpge</span> <span class="o">=</span> <span class="n">RDPGEstimator</span><span class="p">(</span><span class="n">loops</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rdpge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

<span class="n">plot_model_and_sample</span><span class="p">(</span><span class="n">rdpge</span><span class="p">,</span> <span class="s1">&#39;RDPG&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/random_graphs_23_0.png" src="_images/random_graphs_23_0.png" />
</div>
</div>
<p>For the RDPG, looking at the model parameters can be more challenging, since in this
case they are a <span class="math notranslate nohighlight">\(d\)</span>-dimensional vector for each node. We can access the estimated
<span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> matrices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">rdpge</span><span class="o">.</span><span class="n">latent_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">rdpge</span><span class="o">.</span><span class="n">latent_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(213, 3)
(213, 3)
</pre></div>
</div>
</div>
</div>
<p>One way to visualize these multidimensional sets of vectors (each row of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> is
a vector which corresponds to a node) is to use <code class="docutils literal notranslate"><span class="pre">graspologic</span></code>’s <a class="reference external" href="https://microsoft.github.io/graspologic/latest/reference/reference/plotting.html#pairplot"><code class="docutils literal notranslate"><span class="pre">pairplot</span></code></a>, which itself is just a wrapper around <code class="docutils literal notranslate"><span class="pre">seaborn</span></code>’s <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.pairplot.html"><code class="docutils literal notranslate"><span class="pre">pairplot</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graspologic.plot</span> <span class="kn">import</span> <span class="n">pairplot</span>

<span class="n">pairplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Out latent positions&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x13f94a130&gt;
</pre></div>
</div>
<img alt="_images/random_graphs_27_1.png" src="_images/random_graphs_27_1.png" />
</div>
</div>
</div>
<div class="section" id="compare-all-of-the-models-on-this-dataset">
<h3>Compare all of the models on this dataset<a class="headerlink" href="#compare-all-of-the-models-on-this-dataset" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;talk&#39;</span><span class="p">)</span>
<span class="c1"># colormapping</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;RdBu_r&quot;</span><span class="p">)</span>

<span class="n">center</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>

<span class="c1"># heatmapping</span>
<span class="n">heatmap_kws</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">inner_hier_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">hier_label_fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">title_pad</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
    <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.6</span><span class="p">,</span>
    <span class="n">sort_nodes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="n">rdpge</span><span class="p">,</span> <span class="n">dcsbme</span><span class="p">,</span> <span class="n">dcer</span><span class="p">,</span> <span class="n">sbme</span><span class="p">,</span> <span class="n">er</span><span class="p">]</span>
<span class="n">model_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;RDPG&quot;</span><span class="p">,</span> <span class="s2">&quot;DCSBM&quot;</span><span class="p">,</span> <span class="s2">&quot;DCER&quot;</span><span class="p">,</span> <span class="s2">&quot;SBM&quot;</span><span class="p">,</span> <span class="s2">&quot;ER&quot;</span><span class="p">]</span>

<span class="n">heatmap</span><span class="p">(</span><span class="n">adj</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Data&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">heatmap_kws</span><span class="p">)</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">p_mat_</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">model_names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">heatmap_kws</span><span class="p">)</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">p_mat_</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">model_names</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">heatmap_kws</span><span class="p">)</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">p_mat_</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">model_names</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">**</span><span class="n">heatmap_kws</span><span class="p">)</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">p_mat_</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">model_names</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="o">**</span><span class="n">heatmap_kws</span><span class="p">)</span>
<span class="n">heatmap</span><span class="p">(</span><span class="n">models</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">p_mat_</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">model_names</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="o">**</span><span class="n">heatmap_kws</span><span class="p">)</span>


<span class="c1"># add colorbar</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
<span class="n">sm</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">dcsbme</span><span class="o">.</span><span class="n">p_mat_</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
    <span class="n">sm</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">,</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
    <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">,</span>
    <span class="n">shrink</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
    <span class="n">fraction</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span>
    <span class="n">drawedges</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Edge probability&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/random_graphs_29_0.png" src="_images/random_graphs_29_0.png" />
</div>
</div>
</div>
<div class="section" id="relationships-among-these-models">
<h3>Relationships among these models<a class="headerlink" href="#relationships-among-these-models" title="Permalink to this headline">¶</a></h3>
<div class="figure align-default" id="model-relationships">
<img alt="_images/model-relationships.png" src="_images/model-relationships.png" />
<p class="caption"><span class="caption-number">Fig. 4 </span><span class="caption-text">Relationships among independent edge models (some not mentioned here). Figure from
<span id="id4">Chung <em>et al.</em> [<a class="reference internal" href="#id25">4</a>]</span>.</span><a class="headerlink" href="#model-relationships" title="Permalink to this image">¶</a></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Question</p>
<p>When can an SBM also be considered an ER model?</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Question</p>
<p>When can an SBM be considered a DCSBM?</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Question</p>
<p>When can an RDPG be considered a SBM?</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Question</p>
<p>When can an RDPG be considered a DCSBM?</p>
<p>Hint: have a look at the last plot in <a class="reference external" href="https://docs.neurodata.io/notebooks/pedigo/graspologic/2020/09/24/latent_model_tutorial.html">this notebook</a>.</p>
</div>
</div>
</div>
<div class="section" id="barabasi-albert-model">
<h2>Barabasi-Albert model<a class="headerlink" href="#barabasi-albert-model" title="Permalink to this headline">¶</a></h2>
<p>Here, we quickly give one example of a non-independent edge model.</p>
<p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Barab%C3%A1si%E2%80%93Albert_model"><strong>Barabasi-Albert (BA) model</strong></a> is a model based on the idea of <strong>preferential attachment</strong>, sometimes called “rich-get-richer” phenomena.</p>
<p>In contrast to the previous models, the BA model is based on a time-evolving process.
Put simply, the idea is that nodes with higher degrees at time <span class="math notranslate nohighlight">\(t\)</span> are more likely to
make new edges at time <span class="math notranslate nohighlight">\(t+1\)</span>.</p>
<p>Generating this model follows a fairly simple process. First, at time <span class="math notranslate nohighlight">\(t=0\)</span>, we start
with <span class="math notranslate nohighlight">\(n_0\)</span> nodes in some pre-specified configuration. At time <span class="math notranslate nohighlight">\(t=1\)</span>, we add one new node
which makes <span class="math notranslate nohighlight">\(m\)</span> edges to the existing network. The probability <span class="math notranslate nohighlight">\(p_i\)</span> that this new node
is connected to node <span class="math notranslate nohighlight">\(i\)</span> is simply</p>
<div class="math notranslate nohighlight">
\[ p_i = \frac{k_i}{\sum_j k_j} \]</div>
<p>where <span class="math notranslate nohighlight">\(k_i\)</span> is the degree of node <span class="math notranslate nohighlight">\(i\)</span>. This formula just says to connect in proportion
to the degree of existing nodes.</p>
<p>Then, this process is repeated until the desired number of nodes is reached.</p>
<p><code class="docutils literal notranslate"><span class="pre">networkx</span></code> has a function <a class="reference external" href="https://networkx.org/documentation/stable/reference/generated/networkx.generators.random_graphs.barabasi_albert_graph.html#networkx-generators-random-graphs-barabasi-albert-graph"><code class="docutils literal notranslate"><span class="pre">barabasi_albert_graph</span></code></a>
for creating networks this way.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># number of desired nodes </span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># number of edges each node should make</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">barabasi_albert_graph</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_kamada_kawai</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/random_graphs_32_0.png" src="_images/random_graphs_32_0.png" />
</div>
</div>
</div>
<div class="section" id="other-models">
<h2>Other models<a class="headerlink" href="#other-models" title="Permalink to this headline">¶</a></h2>
<p>Many other network models have been described which we haven’t had time to cover here:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Watts%E2%80%93Strogatz_model">Watts-Strogatz model</a> for reproducing so-called “small-world” properties of many real networks, wherein there are relatively short paths among any pair of nodes even in a large network.</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Configuration_model">Configuration model</a> which exactly replicated a given degree distribution.</p></li>
</ul>
</div>
<div class="section" id="bespoke-models">
<h2>“Bespoke” models<a class="headerlink" href="#bespoke-models" title="Permalink to this headline">¶</a></h2>
<p>Your network model does not just have to rely on the network itself, but can actually
include other factors relevant to the application domain. For instance, one could use
the spatial location of brain regions as part of a network model of the brain.</p>
<div class="figure align-default" id="model-examples-brain">
<img alt="_images/model-examples-brain.png" src="_images/model-examples-brain.png" />
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">Example models of brain connectivity. Figure from <span id="id5">Klimm <em>et al.</em> [<a class="reference internal" href="#id57">5</a>]</span></span><a class="headerlink" href="#model-examples-brain" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p id="id6"><dl class="citation">
<dt class="label" id="id26"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>Avanti Athreya, Donniell E Fishkind, Minh Tang, Carey E Priebe, Youngser Park, Joshua T Vogelstein, Keith Levin, Vince Lyzinski, and Yichen Qin. Statistical inference on random dot product graphs: a survey. <em>The Journal of Machine Learning Research</em>, 18(1):8393–8484, 2017.</p>
</dd>
<dt class="label" id="id34"><span class="brackets"><a class="fn-backref" href="#id1">2</a></span></dt>
<dd><p>Stephen J Young and Edward R Scheinerman. Random dot product graph models for social networks. In <em>International Workshop on Algorithms and Models for the Web-Graph</em>, 138–149. Springer, 2007.</p>
</dd>
<dt class="label" id="id33"><span class="brackets"><a class="fn-backref" href="#id2">3</a></span></dt>
<dd><p>Peter D Hoff, Adrian E Raftery, and Mark S Handcock. Latent space approaches to social network analysis. <em>Journal of the american Statistical association</em>, 97(460):1090–1098, 2002.</p>
</dd>
<dt class="label" id="id25"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Jaewon Chung, Eric Bridgeford, Jesús Arroyo, Benjamin D Pedigo, Ali Saad-Eldin, Vivek Gopalakrishnan, Liang Xiang, Carey E Priebe, and Joshua T Vogelstein. Statistical connectomics. <em>Annual Review of Statistics and Its Application</em>, 8:463–492, 2021.</p>
</dd>
<dt class="label" id="id57"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>Florian Klimm, Danielle S Bassett, Jean M Carlson, and Peter J Mucha. Resolving structural variability in network models and the brain. <em>PLoS computational biology</em>, 10(3):e1003491, 2014.</p>
</dd>
</dl>
</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="centrality.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Centrality measures</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="clarke.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Clarke - final project placeholder</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Benjamin D. Pedigo<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>